repos:
  - repo: https://github.com/pycqa/flake8
    rev: 7.3.0
    hooks:
      - id: flake8
        additional_dependencies:
          - flake8-bugbear>=24.0.0

  # Sync Jupyter notebooks from Jupytext .py sources
  - repo: local
    hooks:
      - id: jupytext-sync
        name: Sync tutorial notebooks
        entry: bash -c 'for f in "$@"; do jupytext --to notebook "$f" && git add "${f%.py}.ipynb"; done' --
        language: system
        files: ^tutorials/.*\.py$
        pass_filenames: true
        stages: [commit]

  # Run tests on push (not every commit)
  - repo: local
    hooks:
      - id: pytest
        name: Run pytest
        entry: pytest
        language: system
        pass_filenames: false
        always_run: true
        stages: [pre-push]
